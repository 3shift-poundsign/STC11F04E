C51 COMPILER V9.57.0.0   MAIN                                                              10/22/2019 17:17:38 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\MDK\install\Core\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg52.h>
   2          #define uchar unsigned char
   3          #define uint unsigned int
   4          
   5          sbit DAT = P3^0;                                // 74HC164 数据输入端口
   6          sbit CLK = P3^1;                                // 74HC164 时钟输入端口
   7          uint num = 0;                                   // 显示的数字
   8          
   9          // 定义数码管段选(不加小数点0~9)
  10          uchar code table1[]={0x81,0xD7,0xC8,0xC2,0x96,0xA2,0xA0,0xC7,0x80,0x82};
  11          
  12          /**********************************************************
  13          *  函数名称：低精度延时函数
  14          *  日期：2019-9-7
  15          *  姓名：ZhangHJ
  16          *  说明：嵌套循环延时
  17          ***********************************************************/
  18          void delay(unsigned int mstime)
  19          {
  20   1              int i,j;
  21   1              for(i=mstime; i>=0; i--)
  22   1                      for(j=114; j>=0; j--);
  23   1      }
  24          
  25          
  26          
  27          /**********************************************************
  28          *  函数名称：74HC164发送Byte数据函数
  29          *  日期：2019-9-29
  30          *  姓名：ZhangHJ
  31          *  说明：74HC164移位寄存器输入一字节数据发给寄存器
  32          ***********************************************************/
  33          void SendByte_74HC164(uchar byte)
  34          {
  35   1              uchar num,c;
  36   1              num=table1[byte];
  37   1              for(c=0; c<8; c++)
  38   1              {
  39   2                      DAT=num&0x01;           // P3^0 --> 0000 000x
  40   2                      CLK=0;                          // 制造一个上升沿
  41   2                      CLK=1;
  42   2                      num>>=1;                        // 将数据发送到寄存器
  43   2              }
  44   1      }
  45          
  46          
  47          
  48          /**********************************************************
  49          *  函数名称：配置外部中断0
  50          *  日期：2019-10-22
  51          *  姓名：ZhangHJ
  52          *  说明：1. 选择为下降沿触发方式(为1代表下降沿触发，为0代表低电平触发)
  53          *                2. 使能外部中断0
  54          *                3. 使能总中断
C51 COMPILER V9.57.0.0   MAIN                                                              10/22/2019 17:17:38 PAGE 2   

  55          ***********************************************************/
  56          void configExtInt0()
  57          {
  58   1              IT0 = 1;        //选择为下降沿触发方式(为1代表下降沿触发，为0代表低电平触发)
  59   1              EX0 = 1;        //使能外部中断0
  60   1              EA = 1;         //使能总中断
  61   1      }
  62          
  63          
  64          /**********************************************************
  65          *  函数名称：外部中断0服务函数
  66          *  日期：2019-10-22
  67          *  姓名：ZhangHJ
  68          *  说明：中断服务函数功能为,使num在0~9之间循环变化
  69          ***********************************************************/
  70          void extInt0() interrupt 0
  71          {
  72   1              num ++;
  73   1              num = num % 10;
  74   1      }
  75          
  76          
  77          // 主函数功能：当按下按键KEY时,触发外部中断0,改变数码管显示的数值(0~9)
  78          int main()
  79          {
  80   1              configExtInt0();                // 配置外部中断0
  81   1              P1 &= 0xf0;                             // 位选全部选中
  82   1              while(1)
  83   1              {
  84   2                      SendByte_74HC164(num);
  85   2                      delay(600);
  86   2              }
  87   1              
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    141    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
